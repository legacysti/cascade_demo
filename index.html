<!--
/**
*Name: index.html
*Description: Home page for cascade demo app
*@Authors:
*Matthew Ong
*@Since: 08/31/16
**/
-->

<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="main.js"></script>
        <!--
        //<script type="text/javascript" src="https://www.google.com/jsapi"></script>
        //<script src="getInfo.js"></script>
        //<script type="text/javascript" src="drawData.js"></script>
        //<link rel="stylesheet" type="text/css" href="prettify.css">
    -->
</head>

<h1>What is the weather like?</h1>

<!--
<button onclick="currentWeather()">Current Weather</button>

<button onclick="fetchWeather()">Fetch Weather</button>

<p id="demo"></p>

<weather>
   <span class="conditions_current"></span>
   <infomation>
     <span class="temperature"></span>
     <span class="sunrise"></span>
     <span class="sunset"></span>
     <span class="wind"></span>
     <span class="precip_prob"></span>
     <span class="humidity"></span>
   </infomation>
</weather>
-->

<p id="ac">AC switches:</p>
<p id="heater"> Heater switchs </p>
<button onclick="getData()">Get Data</button>

    <script>

    function incString(string){
        var num = Number(string);
        num++;
        var str = num.toString();
        if(str.length < 2){
            return "0"+str;
        }
        else{
            return str;
        }
    }

    function getData(){

        var apiKey = 'f33d413250b6d07e6fa54b0a0d1bd5fa';
        var url = 'https://api.forecast.io/forecast/';
        var lati = 45.5898;
        var longi = -122.5951;
        var year = "2016";
        var month = "06";
        var day = "00";
        var data;
        var acOn = 0;
        var heaterOn = 0;
        var dateArr = [];
        var acArr = [];
        var heatArr = [];
        var resultJson;

        for (j = 0; j < 2; j++){//for each day
            //console.log("day before: "+day);
            //increment day
            day = incString(day);
            //console.log("day of: "+ day);
            //call api to GET json
            $.getJSON(url + apiKey + "/" + lati + "," + longi + "," +year+"-"+month+"-"+day+"T00:00:00" +"?callback=?", function(data) {
              //console.log(data);
              //resultJson = data;
              //iterate through JSON to find the temperatures of evvery hour for the day

              for (i = 0; i < data.hourly.data.length; i++){
                  if (data.hourly.data[i].temperature > 75){
                      acOn = acOn+1;
                  }
                  else if (data.hourly.data[i].temperature < 62) {
                      heaterOn = heaterOn+1;
                  }
              }

                  $('#ac').html('and the ac was turned on ' + acOn + " times.");
                  console.log("ac "+acOn);
                  acArr.push(acOn);
                  $('#heater').html('and the heater was turned on ' + heaterOn + " times.");
                  console.log("heater "+heaterOn);
                  heatArr.push(heaterOn);
                  //reset ac and heater counters
                  acOn = 0;
                  heaterOn = 0;
            });
            //push all data to arrays for later use
            dateArr.push(year+"-"+month+"-"+day);
        }
        console.log(dateArr[0] + ": ac: "+acArr[0]+", heat: "+heatArr[0]);
        console.log(dateArr[1] + ": ac: "+acArr[1]+", heat: "+heatArr[1]);

        /**
        var resultJson = '{'+ '"results"'+'[{'+
            '"date" : "'+year+'-'+month+'-'+day+'"'+','+
            '"ACswitches" : "'+acOn+','+
            '"heaterSwitches" : "'+heaterOn+
            '},'+
        ']}}';
        **/

        /**
        $.getJSON(url + apiKey + "/" + lati + "," + longi + "?callback=?", function(data) {
              //console.log(data);
              $('#weather').html('and the temperature is: ' + data.hourly.data[0].temperature);
            });
        **/
        ///**


        //**/
        //$('#weather').html('and the temperature is: ' + resultJson.hourly.data[0].temperature);


        //console.log(resultJson.currently.temperature);

        //for (i = 0; i < resultJson.hourly.data.length; i++){
        //    console.log(resultJson.hourly.data[0].temperature);
        //}


    }
    /**
    function checkTemp(id, newUsername) {
        for (var i=0; i<jsonObj.length; i++) {
            if (jsonObj[i].Id === id) {
                jsonObj[i].Username = newUsername;
                return;
            }
        }
    }
    **/
    </script>



<body>
    <!--
    <h3> What data would you like to view?</h3>

    <ul id="navbar">

        <li><a href="artist.html">Artists</a></li>
        <li><a href="userInfo.html">Users</a></li>
        <li><a href="tracks.html">Tracks</a></li>
        <li><a href="login.html">Log In</a></li>
    </ul>

    <div id="search_results">

    </div>
    -->
</body>
</html>
